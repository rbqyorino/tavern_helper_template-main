目前我想制作一个视觉小说界面，类似与galgame游戏

我希望我的视觉小说能够在能够通过正则特定的格式，把文本转换成对应的格式、背景音乐、对话。

需要处理的结构是：
背景和音乐：
[bg|图片链接或别名]: 设置或更换背景图片。支持淡入淡出等过渡效果。
[cg|图片链接或别名]: 显示一张CG，为一张插画。
[bgm|${符合当前场景氛围的BGM}]：为当前场景播放背景音乐
[hide_cg]：不显示cg
两种对话格式：
旁白||${旁白内容}
${角色名}|${角色的位置(L1、L2、L3、L4)}|${角色的立绘名，若没有则留空}|${角色的对话，最后可附加动作指令, 如[action|角色名|shake]}
选择功能：
[choice|${选项一的内容}|${选项二的内容}|${选项三的内容}]: 暂停剧情，并在屏幕上显示几个可点击的选项按钮。当用户点击其中一个选项后，该选项的文本会自动作为用户的输入发送给AI，从而推动剧情发展。

一些解释：
- 界面一次性最多四个角色，从左到右分别是L1、L2、L3、L4
- “[choice|${选项1}|${选项2}|${选项3}]”为玩家可以点击选项，然后在sillytavern的输入框内容输入选择的选项内容
- 需要将当前未说话的角色立绘自动变暗，突出正在说话的角色。

现在介绍一下运动特效：
- 角色抖动`shake`。指定角色的立绘产生晃动的动画效果，表达例如：害怕、生气、强调
- 角色向上跳`jump_up`。让角色立绘做一个向上跳动的动作，表达例如：惊讶、开心、被吓到
- 角色向下蹲`jump_down`。让角色立绘做一个向下蹲下的动作，表达例如：捡东西、躲藏、失落、表示肯定
- 角色立绘放大缩小`near`和`away`，角色的立绘会放大/缩小，表达例如：靠近、远离
- 地图切换：假设从A背景→B背景，B背景会从左往右逐渐替换掉A背景
- 音乐显示：界面最开始，右上角会弹窗出现此时的音乐名字，2s后弹窗消失
- 角色立绘出现/消失：角色立绘有淡入淡出特效
- CG的出现的位置应在对话框上方，不影响玩家观看对话框

图片、立绘、和背景音乐是可以靠外表链接生成。其链接的通式为“`https://gitgud.io/RBQ/amakano3/-/raw/master/${文件名字}`。例如“角色1|L1|illu_1|你好，我叫“角色1”[action|角色1|jump_up]”中立绘“illu_1”对应地址为“https://gitgud.io/RBQ/amakano3/-/raw/master/illu_1.png”、[cg|CG1]中CG1地址为“https://gitgud.io/RBQ/amakano3/-/raw/master/CG1.png”、[bgm|bgm_1]中“bgm_1”地址为“https://gitgud.io/RBQ/amakano3/-/raw/master/bgm_1.mp3”

现在请你模仿“异世界和平.html”的代码，设计我想要的前端代码。你可以直接使用、复制“异世界和平.html”的代码并且删除不需要的部分。设计的代码放在src\gal内





